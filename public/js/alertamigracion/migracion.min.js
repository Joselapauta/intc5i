const userForm = document.getElementById('formMigracion');
const alertMessage = document.getElementById('alertMessage');
let res;

userForm.addEventListener('submit', async function (event) {

    event.preventDefault();

    const bodyData = {

        fecha: document.getElementById('fecha').value,
        institucion: document.getElementById('institucion-actuante').value,
        paisprocedencia: document.getElementById('paisprocedencia').value,
        comandoConjunto: document.getElementById('ComandoConjunto').value,
        //puerto: document.getElementById('Puerto').value,
        nacionalidad: document.getElementById('nacionalidad-detenidos').value,
        tipoEventualidad: document.getElementById('tipo-eventualidad').value,
        amenaza: document.getElementById('Amenaza').value,
        provincia: document.getElementById('provincia').value,
        //decomiso: document.getElementById('decomisos-mercancias').value,
        cantidad: document.getElementById('cantidad').value
    };
    //console.log(bodyData)

    res = await alertaMigracion(bodyData);
    userForm.reset();

    if (res.status === 'success') {
        alertMessage.style.display = 'block';
        alertMessage.innerHTML = `<div class='alert alert-success' role='alert'>${res.message}</div>`;
    } else {
        alertMessage.style.display = 'block';
        alertMessage.innerHTML = `<div class='alert alert-warning' role='alert'>${res.message}</div>`;
    }

})


const alertaMigracion = async (bodyData) => {
    try {
        const res = await fetch('/migracion', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            bodyform: JSON.stringify(bodyData)
        })
        if (res.ok) {
            const data = await res.json();
            
            return data;
        }
    } catch (error) {
        return { status: 'error', message: 'Error en la solicitud' };
    }
}